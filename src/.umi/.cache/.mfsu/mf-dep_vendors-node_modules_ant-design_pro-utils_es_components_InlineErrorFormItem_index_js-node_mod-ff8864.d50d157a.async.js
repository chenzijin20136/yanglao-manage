(self["webpackChunkant_design_pro"] = self["webpackChunkant_design_pro"] || []).push([["mf-dep_vendors-node_modules_ant-design_pro-utils_es_components_InlineErrorFormItem_index_js-node_mod-ff8864"],{

/***/ "./node_modules/@ant-design/pro-utils/es/components/InlineErrorFormItem/index.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@ant-design/pro-utils/es/components/InlineErrorFormItem/index.js ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var antd_es_form_style__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! antd/es/form/style */ "./node_modules/antd/es/form/style/index.js");
/* harmony import */ var antd_es_form__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! antd/es/form */ "./node_modules/antd/es/form/index.js");
/* harmony import */ var antd_es_popover_style__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! antd/es/popover/style */ "./node_modules/antd/es/popover/style/index.js");
/* harmony import */ var antd_es_popover__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! antd/es/popover */ "./node_modules/antd/es/popover/index.js");
/* harmony import */ var antd_es_space_style__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! antd/es/space/style */ "./node_modules/antd/es/space/style/index.js");
/* harmony import */ var antd_es_space__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! antd/es/space */ "./node_modules/antd/es/space/index.js");
/* harmony import */ var antd_es_progress_style__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! antd/es/progress/style */ "./node_modules/antd/es/progress/style/index.js");
/* harmony import */ var antd_es_progress__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! antd/es/progress */ "./node_modules/antd/es/progress/index.js");
/* harmony import */ var antd_es_config_provider_style__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! antd/es/config-provider/style */ "./node_modules/antd/es/config-provider/style/index.js");
/* harmony import */ var antd_es_config_provider__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! antd/es/config-provider */ "./node_modules/antd/es/config-provider/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @ant-design/icons */ "./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js");
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @ant-design/icons */ "./node_modules/@ant-design/icons/es/icons/CloseCircleFilled.js");
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @ant-design/icons */ "./node_modules/@ant-design/icons/es/icons/CheckCircleFilled.js");
/* harmony import */ var _index_less__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./index.less */ "./node_modules/@ant-design/pro-utils/es/components/InlineErrorFormItem/index.less");
/* harmony import */ var _index_less__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_index_less__WEBPACK_IMPORTED_MODULE_7__);










var _excluded = ["label", "rules", "name", "children", "popoverProps", "progressProps", "form"],
    _excluded2 = ["errorType", "rules", "name", "popoverProps", "children", "progressProps"];

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }






var getStrokeColor = function getStrokeColor(percent) {
  if (percent < 50) {
    return 'error';
  }

  if (percent < 100) {
    return 'warning';
  }

  return 'success';
};

var CircleRender = function CircleRender(_ref) {
  var prefixCls = _ref.prefixCls;
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement("div", {
    className: "".concat(prefixCls, "-rule-content-icon-default")
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement("div", {
    className: "".concat(prefixCls, "-rule-content-icon-default-circle")
  }));
};

var getIcon = function getIcon(fieldError, rule, isTouched, requiredChecked, isValidating, prefixCls) {
  if (isValidating) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(_ant_design_icons__WEBPACK_IMPORTED_MODULE_8__.default, {
      className: "".concat(prefixCls, "-rule-content-icon-loading")
    });
  }

  if (!isTouched) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(CircleRender, {
      prefixCls: prefixCls
    });
  }

  if (!requiredChecked || fieldError.includes(rule.message)) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(_ant_design_icons__WEBPACK_IMPORTED_MODULE_9__.default, {
      className: "".concat(prefixCls, "-rule-content-icon-error")
    });
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(_ant_design_icons__WEBPACK_IMPORTED_MODULE_10__.default, {
    className: "".concat(prefixCls, "-rule-content-icon-success")
  });
};

var Content = function Content(_ref2) {
  var _ref2$rules = _ref2.rules,
      rules = _ref2$rules === void 0 ? [] : _ref2$rules,
      isTouched = _ref2.isTouched,
      isValidating = _ref2.isValidating,
      value = _ref2.value,
      fieldError = _ref2.fieldError,
      progressProps = _ref2.progressProps,
      form = _ref2.form;
  var percent = Math.max(0, Math.min(100, (rules.length - fieldError.length) / rules.length * 100));
  var isMultipleRule = rules.length > 1;
  var requiredRule = rules.find(function (_) {
    return _.required;
  });
  var hasRequired = !!requiredRule;
  var requiredChecked = hasRequired && !fieldError.includes(requiredRule === null || requiredRule === void 0 ? void 0 : requiredRule.message);

  var _useContext = (0,react__WEBPACK_IMPORTED_MODULE_5__.useContext)(antd_es_config_provider__WEBPACK_IMPORTED_MODULE_11__.default.ConfigContext),
      getPrefixCls = _useContext.getPrefixCls;

  var prefixCls = getPrefixCls('pro-inline-error-form-item');
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement("div", {
    className: classnames__WEBPACK_IMPORTED_MODULE_6___default()(prefixCls, _defineProperty({}, "".concat(prefixCls, "-multiple"), isMultipleRule))
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(antd_es_space__WEBPACK_IMPORTED_MODULE_12__.default, {
    direction: "vertical"
  }, (progressProps === undefined || progressProps) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(antd_es_progress__WEBPACK_IMPORTED_MODULE_13__.default, _extends({
    className: "".concat(prefixCls, "-progress-").concat(getStrokeColor(percent)),
    percent: value && isTouched ? percent : 0,
    showInfo: false,
    size: "small",
    strokeLinecap: 'butt'
  }, progressProps)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement("ul", {
    className: "".concat(prefixCls, "-rule")
  }, rules === null || rules === void 0 ? void 0 : rules.map(function (item, idx) {
    var rule = typeof item === 'function' ? item(form) : item;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement("li", {
      key: idx,
      className: "".concat(prefixCls, "-rule-content")
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(antd_es_space__WEBPACK_IMPORTED_MODULE_12__.default, null, getIcon(fieldError, rule, isTouched, hasRequired ? requiredChecked : true, isValidating, prefixCls), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement("span", {
      className: "".concat(prefixCls, "-rule-content-text")
    }, rule.message)));
  }))));
};

var FIX_INLINE_STYLE = {
  marginTop: -5,
  marginBottom: -5,
  marginLeft: 0,
  marginRight: 0
};

var InternalFormItem = function InternalFormItem(_ref3) {
  var label = _ref3.label,
      rules = _ref3.rules,
      name = _ref3.name,
      children = _ref3.children,
      popoverProps = _ref3.popoverProps,
      progressProps = _ref3.progressProps,
      form = _ref3.form,
      rest = _objectWithoutProperties(_ref3, _excluded);

  var fieldError = form.getFieldError(name);
  var value = form.getFieldValue(name);
  var isValidating = form.isFieldValidating(name);
  var isTouched = form.isFieldTouched(name);

  var _useState = (0,react__WEBPACK_IMPORTED_MODULE_5__.useState)(undefined),
      _useState2 = _slicedToArray(_useState, 2),
      visible = _useState2[0],
      setVisible = _useState2[1];

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(antd_es_form__WEBPACK_IMPORTED_MODULE_14__.default.Item, _extends({
    style: FIX_INLINE_STYLE,
    preserve: false,
    name: name,
    validateFirst: false,
    rules: rules // @ts-ignore
    ,
    _internalItemRender: {
      mark: 'pro_table_render',
      render: function render(inputProps, _ref4) {
        var input = _ref4.input,
            extra = _ref4.extra;
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(antd_es_popover__WEBPACK_IMPORTED_MODULE_15__.default, {
          trigger: (popoverProps === null || popoverProps === void 0 ? void 0 : popoverProps.trigger) || 'focus',
          placement: popoverProps === null || popoverProps === void 0 ? void 0 : popoverProps.placement,
          visible: visible,
          onVisibleChange: setVisible,
          content: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(Content, {
            fieldError: fieldError,
            value: value,
            isValidating: isValidating,
            isTouched: isTouched,
            rules: rules,
            progressProps: progressProps,
            form: form
          })
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement("div", null, input, extra));
      }
    }
  }, rest), children);
};

var InlineErrorFormItem = function InlineErrorFormItem(props) {
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(antd_es_form__WEBPACK_IMPORTED_MODULE_14__.default.Item, {
    shouldUpdate: true,
    noStyle: true
  }, function (form) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(InternalFormItem, _extends({}, props, {
      form: form
    }));
  });
};

/* harmony default export */ __webpack_exports__["default"] = (function (props) {
  var errorType = props.errorType,
      rules = props.rules,
      name = props.name,
      popoverProps = props.popoverProps,
      children = props.children,
      progressProps = props.progressProps,
      rest = _objectWithoutProperties(props, _excluded2);

  if (name && (rules === null || rules === void 0 ? void 0 : rules.length) && errorType === 'popover') {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(InlineErrorFormItem, _extends({
      name: name,
      rules: rules,
      popoverProps: popoverProps,
      progressProps: rules.length > 1 ? progressProps : false
    }, rest), children);
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(antd_es_form__WEBPACK_IMPORTED_MODULE_14__.default.Item, _extends({
    rules: rules
  }, rest, {
    style: _objectSpread(_objectSpread({}, FIX_INLINE_STYLE), rest.style),
    name: name
  }), children);
});

/***/ }),

/***/ "./node_modules/@ant-design/pro-utils/es/getFieldPropsOrFormItemProps/index.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@ant-design/pro-utils/es/getFieldPropsOrFormItemProps/index.js ***!
  \*************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _runFunction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../runFunction */ "./node_modules/@ant-design/pro-utils/es/runFunction/index.js");

/**
 * 因为 fieldProps 支持了 function 所以新增了这个方法
 *
 * @param fieldProps
 * @param form
 */

var getFieldPropsOrFormItemProps = function getFieldPropsOrFormItemProps(fieldProps, form, extraProps) {
  if (form === undefined) {
    return fieldProps;
  }

  return (0,_runFunction__WEBPACK_IMPORTED_MODULE_0__.runFunction)(fieldProps, form, extraProps);
};

/* harmony default export */ __webpack_exports__["default"] = (getFieldPropsOrFormItemProps);

/***/ }),

/***/ "./node_modules/@ant-design/pro-utils/es/useEditableArray/index.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@ant-design/pro-utils/es/useEditableArray/index.js ***!
  \*************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "recordKeyToString": function() { return /* binding */ recordKeyToString; },
/* harmony export */   "SaveEditableAction": function() { return /* binding */ SaveEditableAction; },
/* harmony export */   "DeleteEditableAction": function() { return /* binding */ DeleteEditableAction; },
/* harmony export */   "defaultActionRender": function() { return /* binding */ defaultActionRender; }
/* harmony export */ });
/* harmony import */ var antd_es_message_style__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! antd/es/message/style */ "./node_modules/antd/es/message/style/index.js");
/* harmony import */ var antd_es_message__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! antd/es/message */ "./node_modules/antd/es/message/index.js");
/* harmony import */ var antd_es_popconfirm_style__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! antd/es/popconfirm/style */ "./node_modules/antd/es/popconfirm/style/index.js");
/* harmony import */ var antd_es_popconfirm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! antd/es/popconfirm */ "./node_modules/antd/es/popconfirm/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_util_es_hooks_useMergedState__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rc-util/es/hooks/useMergedState */ "./node_modules/rc-util/es/hooks/useMergedState.js");
/* harmony import */ var antd_es_table_hooks_useLazyKVMap__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! antd/es/table/hooks/useLazyKVMap */ "./node_modules/antd/es/table/hooks/useLazyKVMap.js");
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @ant-design/icons */ "./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js");
/* harmony import */ var _ant_design_pro_provider__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ant-design/pro-provider */ "./node_modules/@ant-design/pro-provider/es/index.js");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-dom */ "./node_modules/react-dom/index.js");
/* harmony import */ var lodash_merge__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! lodash.merge */ "./node_modules/lodash.merge/index.js");
/* harmony import */ var lodash_merge__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(lodash_merge__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var rc_util_es_utils_set__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! rc-util/es/utils/set */ "./node_modules/rc-util/es/utils/set.js");
/* harmony import */ var _useMountMergeState__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../useMountMergeState */ "./node_modules/@ant-design/pro-utils/es/useMountMergeState/index.js");
/* harmony import */ var _components_ProFormContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../components/ProFormContext */ "./node_modules/@ant-design/pro-utils/es/components/ProFormContext/index.js");
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! .. */ "./node_modules/@ant-design/pro-utils/es/hooks/usePrevious/index.js");




var _excluded = ["map_row_parentKey", "map_row_key"],
    _excluded2 = ["map_row_key"];

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/* eslint-disable react-hooks/exhaustive-deps */











var recordKeyToString = function recordKeyToString(rowKey) {
  if (Array.isArray(rowKey)) return rowKey.join(',');
  return rowKey;
};
/**
 * 使用map 来删除数据，性能一般 但是准确率比较高
 *
 * @param params
 * @param action
 */

function editableRowByKey(params, action) {
  var _recordKeyToString;

  var getRowKey = params.getRowKey,
      row = params.row,
      data = params.data,
      childrenColumnName = params.childrenColumnName;
  var key = (_recordKeyToString = recordKeyToString(params.key)) === null || _recordKeyToString === void 0 ? void 0 : _recordKeyToString.toString();
  var kvMap = new Map();
  /**
   * 打平这个数组
   *
   * @param records
   * @param parentKey
   */

  function dig(records, map_row_parentKey) {
    records.forEach(function (record, index) {
      var recordKey = getRowKey(record, index).toString(); // children 取在前面方便拼的时候按照反顺序放回去

      if (record && _typeof(record) === 'object' && childrenColumnName in record) {
        dig(record[childrenColumnName] || [], recordKey);
      }

      var newRecord = _objectSpread(_objectSpread({}, record), {}, {
        map_row_key: recordKey,
        children: undefined,
        map_row_parentKey: map_row_parentKey
      });

      delete newRecord.children;

      if (!map_row_parentKey) {
        delete newRecord.map_row_parentKey;
      }

      kvMap.set(recordKey, newRecord);
    });
  }

  dig(data);

  if (action === 'update') {
    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));
  }

  if (action === 'delete') {
    kvMap.delete(key);
  }

  var fill = function fill(map) {
    var kvArrayMap = new Map();
    var kvSource = [];
    map.forEach(function (value) {
      if (value.map_row_parentKey) {
        // @ts-ignore
        var map_row_parentKey = value.map_row_parentKey,
            map_row_key = value.map_row_key,
            reset = _objectWithoutProperties(value, _excluded);

        if (kvArrayMap.has(map_row_key)) {
          reset[childrenColumnName] = kvArrayMap.get(map_row_key);
        }

        kvArrayMap.set(map_row_parentKey, [].concat(_toConsumableArray(kvArrayMap.get(map_row_parentKey) || []), [reset]));
      }
    });
    map.forEach(function (value) {
      if (!value.map_row_parentKey) {
        // @ts-ignore
        var map_row_key = value.map_row_key,
            rest = _objectWithoutProperties(value, _excluded2);

        if (kvArrayMap.has(map_row_key)) {
          var item = _objectSpread(_objectSpread({}, rest), {}, _defineProperty({}, childrenColumnName, kvArrayMap.get(map_row_key)));

          kvSource.push(item);
          return;
        }

        kvSource.push(rest);
      }
    });
    return kvSource;
  };

  var source = fill(kvMap);
  return source;
}
/**
 * 保存按钮的dom
 *
 * @param ActionRenderConfig
 */


function SaveEditableAction(_ref) {
  var recordKey = _ref.recordKey,
      onSave = _ref.onSave,
      form = _ref.form,
      row = _ref.row,
      children = _ref.children,
      newLineConfig = _ref.newLineConfig,
      editorType = _ref.editorType,
      tableName = _ref.tableName;
  var context = (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(_components_ProFormContext__WEBPACK_IMPORTED_MODULE_8__.default);

  var _useMountMergeState = (0,_useMountMergeState__WEBPACK_IMPORTED_MODULE_9__.default)(false),
      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),
      loading = _useMountMergeState2[0],
      setLoading = _useMountMergeState2[1];

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("a", {
    key: "save",
    onClick: /*#__PURE__*/function () {
      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(e) {
        var _context$getFieldForm, isMapEditor, namePath, fields, data, res;

        return regeneratorRuntime.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                e.stopPropagation();
                e.preventDefault();
                _context.prev = 2;
                isMapEditor = editorType === 'Map';
                namePath = [tableName, recordKey].flat(1).filter(Boolean);
                setLoading(true); // @ts-expect-error

                _context.next = 8;
                return form.validateFields(namePath, {
                  recursive: true
                });

              case 8:
                fields = ((_context$getFieldForm = context.getFieldFormatValue) === null || _context$getFieldForm === void 0 ? void 0 : _context$getFieldForm.call(context, namePath)) || form.getFieldValue(namePath);
                data = isMapEditor ? (0,rc_util_es_utils_set__WEBPACK_IMPORTED_MODULE_7__.default)({}, namePath, fields, true) : fields; // 获取数据并保存

                _context.next = 12;
                return onSave === null || onSave === void 0 ? void 0 : onSave(recordKey, // 如果是 map 模式，fields 就是一个值，所以需要set 到对象中
                // 数据模式 fields 是一个对象，所以不需要
                lodash_merge__WEBPACK_IMPORTED_MODULE_6___default()({}, row, data), row, newLineConfig);

              case 12:
                res = _context.sent;
                setLoading(false);
                return _context.abrupt("return", res);

              case 17:
                _context.prev = 17;
                _context.t0 = _context["catch"](2);
                // eslint-disable-next-line no-console
                console.log(_context.t0);
                setLoading(false);
                return _context.abrupt("return", null);

              case 22:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, null, [[2, 17]]);
      }));

      return function (_x) {
        return _ref2.apply(this, arguments);
      };
    }()
  }, loading ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(_ant_design_icons__WEBPACK_IMPORTED_MODULE_10__.default, {
    style: {
      marginRight: 8
    }
  }) : null, children || '保存');
}
/**
 * 删除按钮 dom
 *
 * @param ActionRenderConfig
 */

var DeleteEditableAction = function DeleteEditableAction(_ref3) {
  var recordKey = _ref3.recordKey,
      onDelete = _ref3.onDelete,
      row = _ref3.row,
      children = _ref3.children,
      deletePopconfirmMessage = _ref3.deletePopconfirmMessage,
      cancelEditable = _ref3.cancelEditable;

  var _useMountMergeState3 = (0,_useMountMergeState__WEBPACK_IMPORTED_MODULE_9__.default)(false),
      _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),
      loading = _useMountMergeState4[0],
      setLoading = _useMountMergeState4[1];

  var onConfirm = /*#__PURE__*/function () {
    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
      var res;
      return regeneratorRuntime.wrap(function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              _context2.prev = 0;
              setLoading(true);
              _context2.next = 4;
              return onDelete === null || onDelete === void 0 ? void 0 : onDelete(recordKey, row);

            case 4:
              res = _context2.sent;
              setLoading(false);
              setTimeout(function () {
                cancelEditable(recordKey);
              }, 0);
              return _context2.abrupt("return", res);

            case 10:
              _context2.prev = 10;
              _context2.t0 = _context2["catch"](0);
              // eslint-disable-next-line no-console
              console.log(_context2.t0);
              setLoading(false);
              return _context2.abrupt("return", null);

            case 15:
            case "end":
              return _context2.stop();
          }
        }
      }, _callee2, null, [[0, 10]]);
    }));

    return function onConfirm() {
      return _ref4.apply(this, arguments);
    };
  }();

  return children !== false ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(antd_es_popconfirm__WEBPACK_IMPORTED_MODULE_11__.default, {
    key: "delete",
    title: deletePopconfirmMessage,
    onConfirm: onConfirm
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("a", null, loading ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(_ant_design_icons__WEBPACK_IMPORTED_MODULE_10__.default, {
    style: {
      marginRight: 8
    }
  }) : null, children || '删除')) : null;
};

var CancelEditableAction = function CancelEditableAction(props) {
  var recordKey = props.recordKey,
      tableName = props.tableName,
      newLineConfig = props.newLineConfig,
      form = props.form,
      editorType = props.editorType,
      onCancel = props.onCancel,
      cancelEditable = props.cancelEditable,
      row = props.row,
      cancelText = props.cancelText;
  var context = (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(_components_ProFormContext__WEBPACK_IMPORTED_MODULE_8__.default);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("a", {
    key: "cancel",
    onClick: /*#__PURE__*/function () {
      var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(e) {
        var _context$getFieldForm2;

        var isMapEditor, namePath, fields, record, res;
        return regeneratorRuntime.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                e.stopPropagation();
                e.preventDefault();
                isMapEditor = editorType === 'Map';
                namePath = [tableName, recordKey].flat(1).filter(Boolean);
                fields = ((_context$getFieldForm2 = context.getFieldFormatValue) === null || _context$getFieldForm2 === void 0 ? void 0 : _context$getFieldForm2.call(context, namePath)) || form.getFieldValue(namePath);
                record = isMapEditor ? (0,rc_util_es_utils_set__WEBPACK_IMPORTED_MODULE_7__.default)({}, namePath, fields) : fields;
                _context3.next = 8;
                return onCancel === null || onCancel === void 0 ? void 0 : onCancel(recordKey, record, row, newLineConfig);

              case 8:
                res = _context3.sent;
                cancelEditable(recordKey);
                form.setFieldsValue(row);
                return _context3.abrupt("return", res);

              case 12:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3);
      }));

      return function (_x2) {
        return _ref5.apply(this, arguments);
      };
    }()
  }, cancelText || '取消');
};

function defaultActionRender(row, config) {
  var recordKey = config.recordKey,
      newLineConfig = config.newLineConfig,
      saveText = config.saveText,
      deleteText = config.deleteText;
  return [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(SaveEditableAction, _extends({
    key: "save"
  }, config, {
    row: row
  }), saveText), (newLineConfig === null || newLineConfig === void 0 ? void 0 : newLineConfig.options.recordKey) !== recordKey ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(DeleteEditableAction, _extends({
    key: "delete"
  }, config, {
    row: row
  }), deleteText) : null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(CancelEditableAction, _extends({
    key: "cancel"
  }, config, {
    row: row
  }))];
}
/**
 * 一个方便的hooks 用于维护编辑的状态
 *
 * @param props
 */

function useEditableArray(props) {
  var _useState = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(undefined),
      _useState2 = _slicedToArray(_useState, 2),
      newLineRecord = _useState2[0],
      setNewLineRecord = _useState2[1];

  var newLineRecordRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(undefined); // 这里这么做是为了存上次的状态，不然每次存一下再拿

  newLineRecordRef.current = newLineRecord;
  var editableType = props.type || 'single';

  var _useLazyKVMap = (0,antd_es_table_hooks_useLazyKVMap__WEBPACK_IMPORTED_MODULE_12__.default)(props.dataSource, 'children', props.getRowKey),
      _useLazyKVMap2 = _slicedToArray(_useLazyKVMap, 1),
      getRecordByKey = _useLazyKVMap2[0];

  var _useMergedState = (0,rc_util_es_hooks_useMergedState__WEBPACK_IMPORTED_MODULE_3__.default)([], {
    value: props.editableKeys,
    onChange: props.onChange ? function (keys) {
      var _props$onChange;

      props === null || props === void 0 ? void 0 : (_props$onChange = props.onChange) === null || _props$onChange === void 0 ? void 0 : _props$onChange.call(props, // 计算编辑的key
      keys, // 计算编辑的行
      keys.map(function (key) {
        return getRecordByKey(key);
      }));
    } : undefined
  }),
      _useMergedState2 = _slicedToArray(_useMergedState, 2),
      editableKeys = _useMergedState2[0],
      setEditableRowKeys = _useMergedState2[1];
  /** 一个用来标志的set 提供了方便的 api 来去重什么的 */


  var editableKeysSet = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(function () {
    var keys = editableType === 'single' ? editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.slice(0, 1) : editableKeys;
    return new Set(keys);
  }, [(editableKeys || []).join(','), editableType]);
  var editableKeysRef = (0,___WEBPACK_IMPORTED_MODULE_13__.default)(editableKeys);
  /** 这行是不是编辑状态 */

  var isEditable = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(function (row) {
    var recordKey = props.getRowKey(row, row.index);
    var preIsEditable = editableKeysRef === null || editableKeysRef === void 0 ? void 0 : editableKeysRef.includes(recordKey);
    return {
      recordKey: recordKey,
      isEditable: editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.includes(recordKey),
      preIsEditable: preIsEditable
    };
  }, [(editableKeys || []).join(',')]);
  /**
   * 进入编辑状态
   *
   * @param recordKey
   */

  var startEditable = function startEditable(recordKey) {
    // 如果是单行的话，不允许多行编辑
    if (editableKeysSet.size > 0 && editableType === 'single') {
      antd_es_message__WEBPACK_IMPORTED_MODULE_14__.default.warn(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');

      return false;
    }

    editableKeysSet.add(recordKey);
    setEditableRowKeys(Array.from(editableKeysSet));
    return true;
  };
  /**
   * 退出编辑状态
   *
   * @param recordKey
   */


  var cancelEditable = function cancelEditable(recordKey) {
    // 防止多次渲染
    react_dom__WEBPACK_IMPORTED_MODULE_5__.unstable_batchedUpdates(function () {
      /** 如果这个是 new Line 直接删除 */
      if (newLineRecord && newLineRecord.options.recordKey === recordKey) {
        setNewLineRecord(undefined);
      }

      editableKeysSet.delete(recordKeyToString(recordKey));
      setEditableRowKeys(Array.from(editableKeysSet));
    });
    return true;
  };

  var onValuesChange = function onValuesChange(value, values) {
    var _Object$keys$pop, _newLineRecord$option;

    if (!props.onValuesChange) {
      return;
    }

    var dataSource = props.dataSource; // 这里是把正在编辑中的所有表单数据都修改掉
    // 不然会用 props 里面的 dataSource，数据只有正在编辑中的

    Object.keys(values).forEach(function (recordKey) {
      var editRow = values[recordKey.toString()];
      dataSource = editableRowByKey({
        data: dataSource,
        getRowKey: props.getRowKey,
        row: editRow,
        key: recordKey,
        childrenColumnName: props.childrenColumnName || 'children'
      }, 'update');
    });
    var recordKey = (_Object$keys$pop = Object.keys(value).pop()) === null || _Object$keys$pop === void 0 ? void 0 : _Object$keys$pop.toString();

    if (recordKey.toString() === (newLineRecord === null || newLineRecord === void 0 ? void 0 : (_newLineRecord$option = newLineRecord.options.recordKey) === null || _newLineRecord$option === void 0 ? void 0 : _newLineRecord$option.toString())) {
      cancelEditable(recordKey);
      startEditable(recordKey);
    }

    var editRow = dataSource.find(function (item, index) {
      var _props$getRowKey;

      var key = (_props$getRowKey = props.getRowKey(item, index)) === null || _props$getRowKey === void 0 ? void 0 : _props$getRowKey.toString();
      return key === recordKey;
    }) || _objectSpread(_objectSpread({}, newLineRecord === null || newLineRecord === void 0 ? void 0 : newLineRecord.defaultValue), values[recordKey]);

    props.onValuesChange(editRow, dataSource);
  };
  /**
   * 同时只能支持一行,取消之后数据消息，不会触发 dataSource
   *
   * @param row
   * @param options
   * @name 增加新的行
   */


  var addEditRecord = function addEditRecord(row, options) {
    // 暂时不支持多行新增
    if (newLineRecordRef.current) {
      antd_es_message__WEBPACK_IMPORTED_MODULE_14__.default.warn(props.onlyAddOneLineAlertMessage || '只能新增一行');

      return false;
    } // 如果是单行的话，不允许多行编辑


    if (editableKeysSet.size > 0 && editableType === 'single') {
      antd_es_message__WEBPACK_IMPORTED_MODULE_14__.default.warn(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');

      return false;
    } // 防止多次渲染


    react_dom__WEBPACK_IMPORTED_MODULE_5__.unstable_batchedUpdates(function () {
      var recordKey = props.getRowKey(row, props.dataSource.length);
      editableKeysSet.add(recordKey);
      setEditableRowKeys(Array.from(editableKeysSet));

      if ((options === null || options === void 0 ? void 0 : options.newRecordType) === 'dataSource') {
        var _recordKeyToString2;

        var actionProps = {
          data: props.dataSource,
          getRowKey: props.getRowKey,
          row: _objectSpread(_objectSpread({}, row), {}, {
            map_row_parentKey: (options === null || options === void 0 ? void 0 : options.parentKey) ? (_recordKeyToString2 = recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey)) === null || _recordKeyToString2 === void 0 ? void 0 : _recordKeyToString2.toString() : undefined
          }),
          key: recordKey,
          childrenColumnName: props.childrenColumnName || 'children'
        };
        props.setDataSource(editableRowByKey(actionProps, 'update'));
      } else {
        setNewLineRecord({
          defaultValue: row,
          options: _objectSpread(_objectSpread({}, options), {}, {
            recordKey: recordKey
          })
        });
      }
    });
    return true;
  }; // Internationalization


  var intl = (0,_ant_design_pro_provider__WEBPACK_IMPORTED_MODULE_4__.useIntl)();
  var saveText = intl.getMessage('editableTable.action.save', '保存');
  var deleteText = intl.getMessage('editableTable.action.delete', '删除');
  var cancelText = intl.getMessage('editableTable.action.cancel', '取消');

  var actionRender = function actionRender(row, form) {
    var key = props.getRowKey(row, row.index);
    var config = {
      saveText: saveText,
      cancelText: cancelText,
      deleteText: deleteText,
      addEditRecord: addEditRecord,
      recordKey: key,
      cancelEditable: cancelEditable,
      index: row.index,
      tableName: props.tableName,
      newLineConfig: newLineRecord,
      onCancel: function () {
        var _onCancel = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(recordKey, editRow, originRow, newLine) {
          var _props$onCancel;

          var res;
          return regeneratorRuntime.wrap(function _callee4$(_context4) {
            while (1) {
              switch (_context4.prev = _context4.next) {
                case 0:
                  _context4.next = 2;
                  return props === null || props === void 0 ? void 0 : (_props$onCancel = props.onCancel) === null || _props$onCancel === void 0 ? void 0 : _props$onCancel.call(props, recordKey, editRow, originRow, newLine);

                case 2:
                  res = _context4.sent;
                  return _context4.abrupt("return", res);

                case 4:
                case "end":
                  return _context4.stop();
              }
            }
          }, _callee4);
        }));

        function onCancel(_x3, _x4, _x5, _x6) {
          return _onCancel.apply(this, arguments);
        }

        return onCancel;
      }(),
      onDelete: function () {
        var _onDelete = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(recordKey, editRow) {
          var _props$onDelete;

          var actionProps, res;
          return regeneratorRuntime.wrap(function _callee5$(_context5) {
            while (1) {
              switch (_context5.prev = _context5.next) {
                case 0:
                  actionProps = {
                    data: props.dataSource,
                    getRowKey: props.getRowKey,
                    row: editRow,
                    key: recordKey,
                    childrenColumnName: props.childrenColumnName || 'children'
                  };
                  _context5.next = 3;
                  return props === null || props === void 0 ? void 0 : (_props$onDelete = props.onDelete) === null || _props$onDelete === void 0 ? void 0 : _props$onDelete.call(props, recordKey, editRow);

                case 3:
                  res = _context5.sent;
                  props.setDataSource(editableRowByKey(actionProps, 'delete'));
                  return _context5.abrupt("return", res);

                case 6:
                case "end":
                  return _context5.stop();
              }
            }
          }, _callee5);
        }));

        function onDelete(_x7, _x8) {
          return _onDelete.apply(this, arguments);
        }

        return onDelete;
      }(),
      onSave: function () {
        var _onSave = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(recordKey, editRow, originRow, newLine) {
          var _props$onSave;

          var _ref6, options, res, actionProps;

          return regeneratorRuntime.wrap(function _callee6$(_context6) {
            while (1) {
              switch (_context6.prev = _context6.next) {
                case 0:
                  _ref6 = newLine || {}, options = _ref6.options;
                  _context6.next = 3;
                  return props === null || props === void 0 ? void 0 : (_props$onSave = props.onSave) === null || _props$onSave === void 0 ? void 0 : _props$onSave.call(props, recordKey, editRow, originRow, newLine);

                case 3:
                  res = _context6.sent;
                  // 保存时解除编辑模式
                  cancelEditable(recordKey);

                  if (!(newLine && (options === null || options === void 0 ? void 0 : options.recordKey) === recordKey)) {
                    _context6.next = 8;
                    break;
                  }

                  if ((options === null || options === void 0 ? void 0 : options.position) === 'top') {
                    props.setDataSource([editRow].concat(_toConsumableArray(props.dataSource)));
                  } else {
                    props.setDataSource([].concat(_toConsumableArray(props.dataSource), [editRow]));
                  }

                  return _context6.abrupt("return", res);

                case 8:
                  actionProps = {
                    data: props.dataSource,
                    getRowKey: props.getRowKey,
                    row: editRow,
                    key: recordKey,
                    childrenColumnName: props.childrenColumnName || 'children'
                  };
                  props.setDataSource(editableRowByKey(actionProps, 'update'));
                  return _context6.abrupt("return", res);

                case 11:
                case "end":
                  return _context6.stop();
              }
            }
          }, _callee6);
        }));

        function onSave(_x9, _x10, _x11, _x12) {
          return _onSave.apply(this, arguments);
        }

        return onSave;
      }(),
      form: form,
      editableKeys: editableKeys,
      setEditableRowKeys: setEditableRowKeys,
      deletePopconfirmMessage: props.deletePopconfirmMessage || '删除此行？'
    };
    var defaultDoms = defaultActionRender(row, config);
    if (props.actionRender) return props.actionRender(row, config, {
      save: defaultDoms[0],
      delete: defaultDoms[1],
      cancel: defaultDoms[2]
    });
    return defaultDoms;
  };

  return {
    editableKeys: editableKeys,
    setEditableRowKeys: setEditableRowKeys,
    isEditable: isEditable,
    actionRender: actionRender,
    startEditable: startEditable,
    cancelEditable: cancelEditable,
    addEditRecord: addEditRecord,
    newLineRecord: newLineRecord,
    preEditableKeys: editableKeysRef,
    onValuesChange: onValuesChange
  };
}

/* harmony default export */ __webpack_exports__["default"] = (useEditableArray);

/***/ }),

/***/ "./node_modules/@ant-design/pro-utils/es/components/InlineErrorFormItem/index.less":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@ant-design/pro-utils/es/components/InlineErrorFormItem/index.less ***!
  \*****************************************************************************************/
/***/ (function() {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ "./node_modules/antd/es/card/style/index.less":
/*!****************************************************!*\
  !*** ./node_modules/antd/es/card/style/index.less ***!
  \****************************************************/
/***/ (function() {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ "./node_modules/antd/es/popconfirm/style/index.less":
/*!**********************************************************!*\
  !*** ./node_modules/antd/es/popconfirm/style/index.less ***!
  \**********************************************************/
/***/ (function() {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ "./node_modules/antd/es/card/style/index.js":
/*!**************************************************!*\
  !*** ./node_modules/antd/es/card/style/index.js ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _style_index_less__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../style/index.less */ "./node_modules/antd/es/style/index.less");
/* harmony import */ var _style_index_less__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_style_index_less__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _index_less__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index.less */ "./node_modules/antd/es/card/style/index.less");
/* harmony import */ var _index_less__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_index_less__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _tabs_style__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../tabs/style */ "./node_modules/antd/es/tabs/style/index.js");
/* harmony import */ var _row_style__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../row/style */ "./node_modules/antd/es/row/style/index.js");
/* harmony import */ var _col_style__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../col/style */ "./node_modules/antd/es/col/style/index.js");

 // style dependencies





/***/ }),

/***/ "./node_modules/antd/es/popconfirm/style/index.js":
/*!********************************************************!*\
  !*** ./node_modules/antd/es/popconfirm/style/index.js ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _style_index_less__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../style/index.less */ "./node_modules/antd/es/style/index.less");
/* harmony import */ var _style_index_less__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_style_index_less__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _popover_style__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../popover/style */ "./node_modules/antd/es/popover/style/index.js");
/* harmony import */ var _button_style__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../button/style */ "./node_modules/antd/es/button/style/index.js");
/* harmony import */ var _index_less__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./index.less */ "./node_modules/antd/es/popconfirm/style/index.less");
/* harmony import */ var _index_less__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_index_less__WEBPACK_IMPORTED_MODULE_3__);
 // style dependencies
// deps-lint-skip: tooltip, popover





/***/ })

}]);